<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="./001-010.css" />
  </head>
  <!-- 引入jquery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="./001-010.js"></script>

  <body>
    <div>
      <h3>目录</h3>
      <div>
        <ul>
          <li>
            <span>1</span>
            <span>
              <a href="#01">overflow 超出显示省略号，点击显示全文</a>
            </span>
          </li>
          <li>
            <span>2</span>
            <span>
              <a href="#02">获取上传音频，视频文件的播放时长</a>
            </span>
          </li>
          <li>
            <span>3</span>
            <span>
              <a href="#03">多页面公用批量删除</a>
            </span>
          </li>
          <li>
            <span>4</span>
            <span>
              <a href="#04">获取终端是IOS还是安卓类型</a>
            </span>
          </li>
          <li>
            <span>5</span>
            <span>
              <a href="#05">CSS图片黑白化</a>
            </span>
          </li>
          <li>
            <span>6</span>
            <span>
              <a href="#06">识别URL转换为a链接</a>
            </span>
          </li>
        </ul>
      </div>
    </div>
    <!-- ******************** 1.overflow 超出显示省略号，点击显示全文 ******************** -->
    <div>
      <h3 id="01">1.overflow 超出显示省略号，点击显示全文</h3>
    </div>
    <div
      id="overflow_ellipsis_box"
      class="overflow_ellipsis"
      onclick="showAll()"
    >
      蹴罢秋千，起来慵整纤纤手。露浓花瘦，薄汗轻衣透。见客入来，袜刬金钗溜。和羞走，倚门回首，却把青梅嗅。
    </div>
    <!-- code area  -->
    <div>
      <textarea name="" id="" cols="150" rows="10">
                    <div
                    id="overflow_ellipsis_box"
                    class="overflow_ellipsis"
                    onclick="showAll()"
                    >
                    蹴罢秋千，起来慵整纤纤手。露浓花瘦，薄汗轻衣透。见客入来，袜刬金钗溜。和羞走，倚门回首，却把青梅嗅。
                </div>
                <script>
                    function showAll() {
                        $("#overflow_ellipsis_box").toggleClass("overflow_ellipsis");
                    }
                </script>
                <style>
                    .overflow_ellipsis {
                        width: 500px;
                        white-space: nowrap;
                        overflow: hidden;
                        text-overflow: ellipsis;
                    }
                </style>
            </textarea
      >
    </div>
    <!-- code area  -->
    <!-- ******************** 2.获取上传音频，视频文件的播放时长 ******************** -->
    <div>
      <h3 id="02">2.获取上传音频，视频文件的播放时长</h3>
    </div>
    <div>
      <input type="file" id="get_duration_file" />
      <div id="info_of_duration_file"></div>
    </div>
    <!-- code area  -->
    <div>
      <textarea name="" id="" cols="150" rows="10">
        <div>
          <input type="file" id="get_duration_file" />
          <div id="info_of_duration_file"></div>
        </div>
        <script>
          $("#get_duration_file").change(function() {
          $("#info_of_duration_file").html("");
          var selected_files = $("#get_duration_file").prop("files");
          for (var i = 0; i < selected_files.length; i++) {
            getDuration(selected_files[i]);
          }
        });
        function getDuration(file) {
          // get the duration of file
          var video = document.createElement("video");
          var fileURL = URL.createObjectURL(file);
          video.src = fileURL;
          // when get the duration arrange the send data and add index
          video.ondurationchange = function() {
            let file_name = file.name;
            let file_type = file.type;
            let file_size = Math.round((file.size / 1048576) * 100) / 100;
            let file_duration = this.duration;
            $("#info_of_duration_file").append(
              "<p>file name: " +
                file_name +
                "</p><p>file type:" +
                file_type +
                " </p><p>file size: " +
                file_size +
                "mb</p><p>file duration: " +
                file_duration +
                "s</p>"
            );
          };
        }
      </script>
    </textarea
      >
    </div>
    <!-- code area  -->
    <!-- ******************** 3.多页面公用批量删除 ******************** -->
    <div>
      <h3 id="03">3.多页面公用批量删除</h3>
    </div>
    <table class="bulk_delete_table">
      <tr>
        <th>
          <input
            type="checkbox"
            id="companies_batch_delete"
            onClick="batch_checkbox('companies')"
          />
        </th>
        <th>company</th>
        <th>address</th>
        <th>owner</th>
      </tr>
      <tr>
        <td>
          <input
            type="checkbox"
            class="companies_checkbox"
            value="1"
            onClick="saveId('companies',this.checked,1)"
          />
        </td>
        <td>AAA</td>
        <td>
          Shanghai
        </td>
        <td>
          Mr.Chen
        </td>
      </tr>
      <tr>
        <td>
          <input
            type="checkbox"
            class="companies_checkbox"
            value="2"
            onClick="saveId('companies',this.checked,2)"
          />
        </td>
        <td>BBB</td>
        <td>
          Shanghai
        </td>
        <td>
          Mr.Wang
        </td>
      </tr>
      <tr>
        <td>
          <input
            type="checkbox"
            class="companies_checkbox"
            value="3"
            onClick="saveId('companies',this.checked,3)"
          />
        </td>
        <td>CCC</td>
        <td>
          Shanghai
        </td>
        <td>
          Miss.Li
        </td>
      </tr>
    </table>

    <table class="bulk_delete_table">
      <tr>
        <th>
          <input
            type="checkbox"
            id="users_batch_delete"
            onClick="batch_checkbox('users')"
          />
        </th>
        <th>user</th>
        <th>email</th>
        <th>age</th>
      </tr>
      <tr>
        <td>
          <input
            type="checkbox"
            class="users_checkbox"
            value="1"
            onClick="saveId('users',this.checked,1)"
          />
        </td>
        <td>AA</td>
        <td>
          admin@gmail.com
        </td>
        <td>
          30
        </td>
      </tr>
      <tr>
        <td>
          <input
            type="checkbox"
            class="users_checkbox"
            value="2"
            onClick="saveId('users',this.checked,2)"
          />
        </td>
        <td>BB</td>
        <td>
          admin@gmail.com
        </td>
        <td>
          30
        </td>
      </tr>
      <tr>
        <td>
          <input
            type="checkbox"
            class="users_checkbox"
            value="3"
            onClick="saveId('users',this.checked,3)"
          />
        </td>
        <td>CC</td>
        <td>
          admin@gmail.com
        </td>
        <td>
          30
        </td>
      </tr>
    </table>

    <!-- code area  -->
    <div>
      <textarea name="" id="" cols="150" rows="10">
 
          <table class="bulk_delete_table">
              <tr>
                <th>
                  <input
                    type="checkbox"
                    id="companies_batch_delete"
                    onClick="batch_checkbox('companies')"
                  />
                </th>
                <th>company</th>
                <th>address</th>
                <th>owner</th>
              </tr>
              <tr>
                <td>
                  <input
                    type="checkbox"
                    class="companies_checkbox"
                    value="1"
                    onClick="saveId('companies',this.checked,1)"
                  />
                </td>
                <td>AAA</td>
                <td>
                  Shanghai
                </td>
                <td>
                  Mr.Chen
                </td>
              </tr>
              <tr>
                <td>
                  <input
                    type="checkbox"
                    class="companies_checkbox"
                    value="2"
                    onClick="saveId('companies',this.checked,2)"
                  />
                </td>
                <td>BBB</td>
                <td>
                  Shanghai
                </td>
                <td>
                  Mr.Wang
                </td>
              </tr>
              <tr>
                <td>
                  <input
                    type="checkbox"
                    class="companies_checkbox"
                    value="3"
                    onClick="saveId('companies',this.checked,3)"
                  />
                </td>
                <td>CCC</td>
                <td>
                  Shanghai
                </td>
                <td>
                  Miss.Li
                </td>
              </tr>
            </table>
        
            <table class="bulk_delete_table">
              <tr>
                <th>
                  <input
                    type="checkbox"
                    id="users_batch_delete"
                    onClick="batch_checkbox('users')"
                  />
                </th>
                <th>user</th>
                <th>email</th>
                <th>age</th>
              </tr>
              <tr>
                <td>
                  <input
                    type="checkbox"
                    class="users_checkbox"
                    value="1"
                    onClick="saveId('users',this.checked,1)"
                  />
                </td>
                <td>AA</td>
                <td>
                  admin@gmail.com
                </td>
                <td>
                  30
                </td>
              </tr>
              <tr>
                <td>
                  <input
                    type="checkbox"
                    class="users_checkbox"
                    value="2"
                    onClick="saveId('users',this.checked,2)"
                  />
                </td>
                <td>BB</td>
                <td>
                  admin@gmail.com
                </td>
                <td>
                  30
                </td>
              </tr>
              <tr>
                <td>
                  <input
                    type="checkbox"
                    class="users_checkbox"
                    value="3"
                    onClick="saveId('users',this.checked,3)"
                  />
                </td>
                <td>CC</td>
                <td>
                  admin@gmail.com
                </td>
                <td>
                  30
                </td>
              </tr>
            </table>
            <script>
              var delete_page = "";
              window.onload = function() {
                localStorage.setItem("companies", "");
                localStorage.setItem("users", "");
              };
              // change the checked status
              function batch_checkbox(page) {
                var value = $("#" + page + "_batch_delete").is(":checked");
                if (value === true) {
                  $("." + page + "_checkbox").prop("checked", true);
                  // get all the id in current page
                  var id_arr = $("." + page + "_checkbox")
                    .map(function() {
                      return this.value;
                    })
                    .get();
                  // put into localStorage
                  localStorage.setItem(page, id_arr);
                } else {
                  $("." + page + "_checkbox").prop("checked", false);
                  // delete all the id in localStorage
                  localStorage.setItem(page, "");
                }
              }
              // when click 「削除」set the delete_page
              function set_delete_page(page_name) {
                this.delete_page = page_name;
              }
              //save or delete id in localstorage
              function saveId(page, checked, id) {
                var id_in_local = localStorage.getItem(page);
                if (checked) {
                  if (!id_in_local) {
                    id_in_local = id;
                  } else {
                    id_in_local += "," + id;
                  }
                } else {
                  $("#" + page + "_batch_delete").prop("checked", false);
                  if (id_in_local.length == 1) {
                    id_in_local = "";
                  } else {
                    id_in_local = id_in_local.split(",");
                    var index = id_in_local.indexOf(id.toString());

                    if (index > -1) {
                      id_in_local.splice(index, 1);
                    }
                  }
                }
                localStorage.setItem(page, id_in_local);
              }
              //batch delete
              function batch_delete() {
                var delete_ids = localStorage.getItem(this.delete_page);
                var delete_arr = delete_ids.split(",");
                $.ajax({
                  url: "/" + this.delete_page + "/bulk_delete",
                  type: "POST",
                  data: {
                    ids: delete_arr
                  },
                  success: function(data) {
                    debugger;
                  }
                }).fail(data => {
                  alert("system error");
                });
              }
              </script>
            </textarea
      >
    </div>
    <!-- code area  -->
    <!-- ******************** 4.获取终端是IOS还是安卓类型 ******************** -->
    <div>
      <h3 id="04">4.获取终端是IOS还是安卓类型</h3>
    </div>
    <button onclick="judgeClient()">显示终端类型</button>
    <!-- code area  -->
    <div>
      <textarea name="" id="" cols="150" rows="10">
          <button onclick="judgeClient()">显示终端类型</button>
          <script>
            function judgeClient() {
              let u = navigator.userAgent;
              let isAndroid = u.indexOf("Android") > -1 || u.indexOf("Adr") > -1; //判断是否是 android终端
              let isIOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //判断是否是 iOS终端
              if (isAndroid) {
                alert("Android");
              } else if (isIOS) {
                alert("iOS");
              } else {
                alert("else");
              }
            }
          </script>
      </textarea>
    </div>
    <!-- code area  -->
    <!-- ******************** 5.CSS图片黑白化 ******************** -->
    <div>
      <h3 id="04">5.CSS图片黑白化</h3>
    </div>
    <div>
      <img src="./img/蓝色花海1.jpeg" alt="" style="width: 300px;" />
      <img
        src="./img/蓝色花海1.jpeg"
        alt=""
        style="
          -webkit-filter: grayscale(100%);
          -moz-filter: grayscale(100%);
          -ms-filter: grayscale(100%);
          -o-filter: grayscale(100%);
          filter: grayscale(100%);
          filter: gray;
          width: 300px;
        "
      />
    </div>
    <!-- code area  -->
    <div>
      <textarea name="" id="" cols="150" rows="10">
          style="
          -webkit-filter: grayscale(100%);
          -moz-filter: grayscale(100%);
          -ms-filter: grayscale(100%);
          -o-filter: grayscale(100%);
          filter: grayscale(100%);
          filter: gray;
          width: 300px;
        "
        </textarea
      >
    </div>
    <!-- ******************** 6.识别URL转换为a链接 ******************** -->
    <div>
      <h3 id="06">6.识别URL转换为a链接</h3>
    </div>
    <div>
      <p>以http开头，空格结尾的字符串将转换为URL，并加下划线</p>
      <p><button onclick="stringToUrl()">转 换</button></p>
      <textarea id="oldUrlString" cols="150" rows="10"></textarea>
      <p id="newUrlString"></p>
    </div>
    <!-- code area  -->
    <div>
      <textarea name="" id="" cols="150" rows="10">
        var reg = /https?:\/\/\S+(\s|\r\n|$)/gi;
        var url = contents.match(reg);
      
        if (url) {
          for (var i = 0; i < url.length; i++) {
            let str = url[i];
            str = str.replace(/\ +/g, "");
            str = str.replace(/[\r\n]/g, "");
            contents = contents.replace(
              str,
              "<a href='" + str + "' target='_blank'>" + str + "</a>"
            );
          }
        }
      </textarea>
    </div>
  </body>
</html>
